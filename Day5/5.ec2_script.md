## AWS EC2 Instance Deployment: Block-by-Block Explanation

This configuration defines the resources needed to launch an Ubuntu EC2 instance within your default VPC.

## 1. Prerequisites

Before running this configuration, ensure the following conditions are met:

1.  **AWS Provider Configured:** Your `provider.tf` (or equivalent file) must have the `aws` provider configured with valid credentials and a target region.
2.  **Public Key File:** A public SSH key file named **`terra-key.pub`** must exist in the same directory as this Terraform file.
 

### 1\. Key Pair Resource Block (`aws_key_pair.my_local_key`)

This block handles the secure login method by uploading your public key to AWS.

```hcl
resource "aws_key_pair" "my_local_key" {
  key_name   = "terra-key"
  public_key = file("terra-key.pub")
}
```

  * **`resource "aws_key_pair" "my_local_key"`**: Defines an SSH key pair resource for secure instance access.
  * **`key_name = "terra-key"`**: Sets the name of the key pair in the AWS console.
  * **`public_key = file("terra-key.pub")`**: Reads the content of the local file `terra-key.pub` to register the public key with AWS.

-----

### 2\. Default VPC Resource Block (`aws_default_vpc.N_default`)

This block references and manages the already existing default network container (VPC) for the region.

```hcl
resource "aws_default_vpc" "N_default" {
  tags = {
    Name = "Default VPC"
  }
}
```

  * **`resource "aws_default_vpc" "N_default"`**: Selects the AWS default VPC in the current region for modification/referencing.
  * **`tags = { Name = "Default VPC" }`**: Applies the specified tag to the existing default VPC.

-----

### 3\. Security Group Resource Block (`aws_security_group.my_sg`)

This resource creates the virtual firewall rules that define what traffic is allowed in and out of the EC2 instance.

```hcl
resource "aws_security_group" "my_sg" {
  name        = "Sg-for-terraform"
  description = "Security group for terraform ec2 instance"
  vpc_id      = aws_default_vpc.N_default.id 
  # ... ingress and egress rules ...
  tags = {
    Name = "Sg-for-terraform" 
  }
}
```

  * **`resource "aws_security_group" "my_sg"`**: Creates a Security Group resource.
  * **`name`** and **`description`**: Sets the human-readable name and purpose of the group.
  * **`vpc_id = aws_default_vpc.N_default.id`**: Associates the firewall with the ID of the default VPC.
  * **`ingress { ... }` (Port 22 & 80)**: Allows **inbound** traffic for SSH (Port 22) and HTTP (Port 80) from all IP addresses (`0.0.0.0/0`).
  * **`egress { ... }` (All Traffic)**: Allows **outbound** traffic on all protocols (`-1`) to all IP addresses (`0.0.0.0/0`).
  * **`tags`**: Applies a tag to the Security Group resource.

-----

### 4\. EC2 Instance Resource Block (`aws_instance.my_ec2`)

This final block launches the virtual server, linking all previously defined resources (Key Pair, VPC, and Security Group).

```hcl
resource "aws_instance" "my_ec2" {
    instance_type = "t2.micro"
    security_groups = [aws_security_group.my_sg.name]
    ami = "ami-0360c520857e3138f"  # ubuntu 
    key_name = aws_key_pair.my_local_key.key_name
    root_block_device {
        # ... volume configuration ...
    }
    tags = {
      Name = "Terraform-EC2-instance" 
    }
}
```

  * **`resource "aws_instance" "my_ec2"`**: Creates an EC2 instance resource.
  * **`instance_type = "t2.micro"`**: Specifies the hardware size of the server.
  * **`security_groups = [...]`**: Attaches the instance to the Security Group by referencing its name.
  * **`ami = "..."`**: Specifies the Amazon Machine Image ID (OS) for the instance (Ubuntu in this case).
  * **`key_name = aws_key_pair.my_local_key.key_name`**: Links the instance to the registered SSH key for remote login.
  * **`root_block_device { ... }`**: Configures the primary hard drive, setting its size to **8GB** and ensuring it is deleted on termination.
  * **`tags`**: Applies a user-defined name tag to the instance.

## 5\. Connecting to the EC2 Instance

Once the EC2 instance is up and running, you can connect to it using SSH with the following command:

### Set Permissions (Linux/macOS)
```bash
chmod 400 terra-key.pem
```
### Connect using SSH 

```bash
ssh -i terra-key.pem ubuntu@<EC2_PUBLIC_IP>
```

Replace `<EC2_PUBLIC_IP>` with the public IP address of your EC2 instance.

* **`ssh -i terra-key.pem`**: Specifies the private key file for authentication.
* **`ubuntu@<EC2_PUBLIC_IP>`**: Connects to the instance using the default Ubuntu user.

Make sure that your security group allows inbound traffic on port 22 (SSH) to connect successfully.